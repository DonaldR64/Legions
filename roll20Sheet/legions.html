<input type="hidden" class="sheet-tabstoggle" name="attr_sheetTab"  value="display"  />
<div>
    <button type="action" name="act_input" >Input</button>
    <button type="action" name="act_display" >Display</button>
    <button type="action" name="act_abilities" >Special Rules</button>
</div>

<div class="sheet-input">
    <div class="2colrow">
        <div class="col">
            <h3>Unit Information</h3>
            <label>Name:</label><input type="text" name="attr_character_name">
            <br>
            <label for="attr_faction">Faction:</label>
            <select name="attr_faction">
                <option value="" selected disabled hidden>Choose here</option>
                <option value="Ultramarines">Ultramarines</option>
                <option value="Blood Angels">Blood Angels</option>
                <option value="Deathguard">Deathguard</option>
                <option value="Salamanders">Salamanders</option>
                <option value="Traitor Auxilia">Traitor Auxilia</option>
                <option value="Loyalist Auxilia">Loyalist Auxilia</option>
                <option value="House Malinax">House Malinax</option>
                <option value="Legio Mortis">Legio Mortis</option>
                <option value="House Raven">House Raven</option>
                <option value="Legio Tempestus">Legio Tempestus</option>



            </select>
        </div>
        <div class="col">
            <h3>Attributes</h3>
            <label>Movement:</label><input type="number" name="attr_movement">
            <label>Save:</label><input type="text" name="attr_save">
            <label>CAF:</label><input type="text" name="attr_caf">
            <label>Morale:</label><input type="text" name="attr_morale">
            <label>Wounds:</label><input type="number" name="attr_wounds">

            <label for="attr_type">Type:</label>
            <select name="attr_type">
                <option value="" selected disabled hidden>Choose here</option>
                <option value="Infantry">Infantry</option>
                <option value="Cavalry">Cavalry</option>
                <option value="Walker">Walker</option>
                <option value="Vehicle">Vehicle</option>
                <option value="Super-Heavy Vehicle">Super-Heavy Vehicle</option>
                <option value="Knight">Knight</option>
                <option value="Titan">Titan</option>
                <option value="Structure">Structure</option>
                <option value="System Unit">System Unit</option>
            </select>           
          </div>
    </div>    
    <label>Special Rules:</label><input type="text" name="attr_special">
    <label for="attr_rank">Rank:</label>
    <select name="attr_rank">
        <option value="" selected disabled hidden>Choose here</option>
        <option value=1>Base</option>
        <option value=2>Heavy</option>
        <option value=3>Specialist</option>
        <option value=4>Commander</option>
    </select>  

    <div class="row">
        <h3>Weapons</h3>

        <div class="weapons">
            <table>
            <thead>
                <tr>
                <th>Equipped</th>
                <th>Weapon</th>
                <th>Range</th>
                <th>Dice</th>
                <th>To Hit</th>
                <th>AP</th>
                <th>Traits</th>
                <th>F/X</th>
                <th>Sound</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><select name="attr_weapon1equipped">
                        <option value = "Off">Off</option>
                        <option value = "Equipped">Equipped</option>
                    </select></td>
                    <td><input type="text" name="attr_weapon1name"></td>    
                    <td><input type="text" name="attr_weapon1range"></td>
                    <td><input type="number" name="attr_weapon1dice"></td>
                    <td><input type="text" name="attr_weapon1tohit"></td>
                    <td><input type="text" name="attr_weapon1ap"></td>
                    <td><input type="text" name="attr_weapon1traits"></td>
                    <td><input type="text" name="attr_weapon1fx"></td>
                    <td><input type="text" name="attr_weapon1sound"></td>                
                </tr>
                <tr>
                    <td><select name="attr_weapon2equipped">
                        <option value = "Off">Off</option>
                        <option value = "Equipped">Equipped</option>
                    </select></td>
                    <td><input type="text" name="attr_weapon2name"></td>    
                    <td><input type="text" name="attr_weapon2range"></td>
                    <td><input type="number" name="attr_weapon2dice"></td>
                    <td><input type="text" name="attr_weapon2tohit"></td>
                    <td><input type="text" name="attr_weapon2ap"></td>
                    <td><input type="text" name="attr_weapon2traits"></td>
                    <td><input type="text" name="attr_weapon2fx"></td>
                    <td><input type="text" name="attr_weapon2sound"></td>                
                </tr>
                <tr>
                    <td><select name="attr_weapon3equipped">
                        <option value = "Off">Off</option>
                        <option value = "Equipped">Equipped</option>
                    </select></td>
                    <td><input type="text" name="attr_weapon3name"></td>    
                    <td><input type="text" name="attr_weapon3range"></td>
                    <td><input type="number" name="attr_weapon3dice"></td>
                    <td><input type="text" name="attr_weapon3tohit"></td>
                    <td><input type="text" name="attr_weapon3ap"></td>
                    <td><input type="text" name="attr_weapon3traits"></td>
                    <td><input type="text" name="attr_weapon3fx"></td>
                    <td><input type="text" name="attr_weapon3sound"></td>                
                </tr>
                <tr>
                    <td><select name="attr_weapon4equipped">
                        <option value = "Off">Off</option>
                        <option value = "Equipped">Equipped</option>
                    </select></td>
                    <td><input type="text" name="attr_weapon4name"></td>    
                    <td><input type="text" name="attr_weapon4range"></td>
                    <td><input type="number" name="attr_weapon4dice"></td>
                    <td><input type="text" name="attr_weapon4tohit"></td>
                    <td><input type="text" name="attr_weapon4ap"></td>
                    <td><input type="text" name="attr_weapon4traits"></td>
                    <td><input type="text" name="attr_weapon4fx"></td>
                    <td><input type="text" name="attr_weapon4sound"></td>                
                </tr>
                <tr>
                    <td><select name="attr_weapon5equipped">
                        <option value = "Off">Off</option>
                        <option value = "Equipped">Equipped</option>
                    </select></td>
                    <td><input type="text" name="attr_weapon5name"></td>    
                    <td><input type="text" name="attr_weapon5range"></td>
                    <td><input type="number" name="attr_weapon5dice"></td>
                    <td><input type="text" name="attr_weapon5tohit"></td>
                    <td><input type="text" name="attr_weapon5ap"></td>
                    <td><input type="text" name="attr_weapon5traits"></td>
                    <td><input type="text" name="attr_weapon5fx"></td>
                    <td><input type="text" name="attr_weapon5sound"></td>                
                </tr>
                <tr>
                    <td><select name="attr_weapon6equipped">
                        <option value = "Off">Off</option>
                        <option value = "Equipped">Equipped</option>
                    </select></td>
                    <td><input type="text" name="attr_weapon6name"></td>    
                    <td><input type="text" name="attr_weapon6range"></td>
                    <td><input type="number" name="attr_weapon6dice"></td>
                    <td><input type="text" name="attr_weapon6tohit"></td>
                    <td><input type="text" name="attr_weapon6ap"></td>
                    <td><input type="text" name="attr_weapon6traits"></td>
                    <td><input type="text" name="attr_weapon6fx"></td>
                    <td><input type="text" name="attr_weapon6sound"></td>                
                </tr>
                <tr>
                    <td><select name="attr_weapon7equipped">
                        <option value = "Off">Off</option>
                        <option value = "Equipped">Equipped</option>
                    </select></td>
                    <td><input type="text" name="attr_weapon7name"></td>    
                    <td><input type="text" name="attr_weapon7range"></td>
                    <td><input type="number" name="attr_weapon7dice"></td>
                    <td><input type="text" name="attr_weapon7tohit"></td>
                    <td><input type="text" name="attr_weapon7ap"></td>
                    <td><input type="text" name="attr_weapon7traits"></td>
                    <td><input type="text" name="attr_weapon7fx"></td>
                    <td><input type="text" name="attr_weapon7sound"></td>                
                </tr>
                <tr>
                    <td><select name="attr_weapon8equipped">
                        <option value = "Off">Off</option>
                        <option value = "Equipped">Equipped</option>
                    </select></td>
                    <td><input type="text" name="attr_weapon8name"></td>    
                    <td><input type="text" name="attr_weapon8range"></td>
                    <td><input type="number" name="attr_weapon8dice"></td>
                    <td><input type="text" name="attr_weapon8tohit"></td>
                    <td><input type="text" name="attr_weapon8ap"></td>
                    <td><input type="text" name="attr_weapon8traits"></td>
                    <td><input type="text" name="attr_weapon8fx"></td>
                    <td><input type="text" name="attr_weapon8sound"></td>                
                </tr>
                <tr>
                    <td><select name="attr_weapon9equipped">
                        <option value = "Off">Off</option>
                        <option value = "Equipped">Equipped</option>
                    </select></td>
                    <td><input type="text" name="attr_weapon9name"></td>    
                    <td><input type="text" name="attr_weapon9range"></td>
                    <td><input type="number" name="attr_weapon9dice"></td>
                    <td><input type="text" name="attr_weapon9tohit"></td>
                    <td><input type="text" name="attr_weapon9ap"></td>
                    <td><input type="text" name="attr_weapon9traits"></td>
                    <td><input type="text" name="attr_weapon9fx"></td>
                    <td><input type="text" name="attr_weapon9sound"></td>                
                </tr>
                <tr>
                    <td><select name="attr_weapon10equipped">
                        <option value = "Off">Off</option>
                        <option value = "Equipped">Equipped</option>
                    </select></td>
                    <td><input type="text" name="attr_weapon10name"></td>    
                    <td><input type="text" name="attr_weapon10range"></td>
                    <td><input type="number" name="attr_weapon10dice"></td>
                    <td><input type="text" name="attr_weapon10tohit"></td>
                    <td><input type="text" name="attr_weapon10ap"></td>
                    <td><input type="text" name="attr_weapon10traits"></td>
                    <td><input type="text" name="attr_weapon10fx"></td>
                    <td><input type="text" name="attr_weapon10sound"></td>                
                </tr>

            </tbody>
            </table>    
        </div>    
    </div>    


</div>



<div class="sheet-display">
    <input type="hidden" name="attr_faction"/>

    <div class="mysheet">
      <div class="attributes">

        <main>
        <input type="hidden" name="attr_faction"/>
          <section class="header f-center">
            <h1><span name="attr_character_name"></span></h1>
            <h3><span name="attr_side"></span><span name="attr_type"></span><span> [</span><span name="attr_scale"></span><span>]</span></h3>
          </section>

          <section class="common f-center">
              <img alt="Character Avatar" name="attr_character_avatar"/>
          </section>

          <section class="att">
            <h3>Attributes</h3>
            <div class="attinfo">
                <div><span>Move</span></div>
                <div><span>Save</span></div>
                <div><span>CAF</span></div>
                <div><span>Morale</span></div>
                <div><span>Wounds</span></div>
                <h4><span name="attr_movement"></span><span>"</span></h4>
                <h4><span name="attr_save"></span></h4>
                <h4><span name="attr_caf"></span></h4>
                <h4><span name="attr_morale"></span></h4>
                <h4><span name="attr_wounds"></span></h4>
            </section>

          <section class="flag">
            <img name="attr_factionImage">
          </section>
          
          <section class="flag2">
            <img name="attr_factionImage">
          </section>

          <section class="special">
            <h3>Special Rules</h3>
            <h4><span name="attr_special0"></span></h4>
            <h4><span name="attr_special1"></span></h4>
            <h4><span name="attr_special2"></span></h4>
            <h4><span name="attr_special3"></span></h4>
            <h4><span name="attr_special4"></span></h4>
            <h4><span name="attr_special5"></span></h4>
            <h4><span name="attr_special6"></span></h4>
            <h4><span name="attr_special7"></span></h4>
            <h4><span name="attr_special8"></span></h4>
            <h4><span name="attr_special9"></span></h4>
          </section>

          <section class="weapon">
            <h3>Weapons</h3>
            <div class="weaponinfo">
                <div><span>Weapon</span></div>
                <div><span>Range</span></div>
                <div><span>Dice</span></div>
                <div><span>To Hit</span></div>
                <div><span>AP</span></div>
                <div><span>Traits</span></div>
            </div>
            <input type="hidden" name="attr_weapon1equipped" class="weapon1-status" value="Off">
            <div class="weapon1">
                <h4><span name="attr_weapon1name"></span></h4>
                <h4><span name="attr_weapon1range"></span></h4>
                <h4><span name="attr_weapon1dice"></span></h4>
                <h4><span name="attr_weapon1tohit"></span></h4>
                <h4><span name="attr_weapon1ap"></span></h4>
                <h4><span name="attr_weapon1traits"></span></h4>
            </div>
            <input type="hidden" name="attr_weapon2equipped" class="weapon2-status" value="Off">
            <div class="weapon2">
                <h4><span name="attr_weapon2name"></span></h4>
                <h4><span name="attr_weapon2range"></span></h4>
                <h4><span name="attr_weapon2dice"></span></h4>
                <h4><span name="attr_weapon2tohit"></span></h4>
                <h4><span name="attr_weapon2ap"></span></h4>
                <h4><span name="attr_weapon2traits"></span></h4>
            </div>
            <input type="hidden" name="attr_weapon3equipped" class="weapon3-status" value="Off">
            <div class="weapon3">
                <h4><span name="attr_weapon3name"></span></h4>
                <h4><span name="attr_weapon3range"></span></h4>
                <h4><span name="attr_weapon3dice"></span></h4>
                <h4><span name="attr_weapon3tohit"></span></h4>
                <h4><span name="attr_weapon3ap"></span></h4>
                <h4><span name="attr_weapon3traits"></span></h4>
            </div>
            <input type="hidden" name="attr_weapon4equipped" class="weapon4-status" value="Off">
            <div class="weapon4">
                <h4><span name="attr_weapon4name"></span></h4>
                <h4><span name="attr_weapon4range"></span></h4>
                <h4><span name="attr_weapon4dice"></span></h4>
                <h4><span name="attr_weapon4tohit"></span></h4>
                <h4><span name="attr_weapon4ap"></span></h4>
                <h4><span name="attr_weapon4traits"></span></h4>
            </div>
            <input type="hidden" name="attr_weapon5equipped" class="weapon5-status" value="Off">
            <div class="weapon5">
                <h4><span name="attr_weapon5name"></span></h4>
                <h4><span name="attr_weapon5range"></span></h4>
                <h4><span name="attr_weapon5dice"></span></h4>
                <h4><span name="attr_weapon5tohit"></span></h4>
                <h4><span name="attr_weapon5ap"></span></h4>
                <h4><span name="attr_weapon5traits"></span></h4>
            </div>
            <input type="hidden" name="attr_weapon6equipped" class="weapon6-status" value="Off">
            <div class="weapon6">
                <h4><span name="attr_weapon6name"></span></h4>
                <h4><span name="attr_weapon6range"></span></h4>
                <h4><span name="attr_weapon6dice"></span></h4>
                <h4><span name="attr_weapon6tohit"></span></h4>
                <h4><span name="attr_weapon6ap"></span></h4>
                <h4><span name="attr_weapon6traits"></span></h4>
            </div>
            <input type="hidden" name="attr_weapon7equipped" class="weapon7-status" value="Off">
            <div class="weapon7">
                <h4><span name="attr_weapon7name"></span></h4>
                <h4><span name="attr_weapon7range"></span></h4>
                <h4><span name="attr_weapon7dice"></span></h4>
                <h4><span name="attr_weapon7tohit"></span></h4>
                <h4><span name="attr_weapon7ap"></span></h4>
                <h4><span name="attr_weapon7traits"></span></h4>
            </div>
            <input type="hidden" name="attr_weapon8equipped" class="weapon8-status" value="Off">
            <div class="weapon8">
                <h4><span name="attr_weapon8name"></span></h4>
                <h4><span name="attr_weapon8range"></span></h4>
                <h4><span name="attr_weapon8dice"></span></h4>
                <h4><span name="attr_weapon8tohit"></span></h4>
                <h4><span name="attr_weapon8ap"></span></h4>
                <h4><span name="attr_weapon8traits"></span></h4>
            </div>
            <input type="hidden" name="attr_weapon9equipped" class="weapon9-status" value="Off">
            <div class="weapon9">
                <h4><span name="attr_weapon9name"></span></h4>
                <h4><span name="attr_weapon9range"></span></h4>
                <h4><span name="attr_weapon9dice"></span></h4>
                <h4><span name="attr_weapon9tohit"></span></h4>
                <h4><span name="attr_weapon9ap"></span></h4>
                <h4><span name="attr_weapon9traits"></span></h4>
            </div>
            <input type="hidden" name="attr_weapon10equipped" class="weapon10-status" value="Off">
            <div class="weapon10">
                <h4><span name="attr_weapon10name"></span></h4>
                <h4><span name="attr_weapon10range"></span></h4>
                <h4><span name="attr_weapon10dice"></span></h4>
                <h4><span name="attr_weapon10tohit"></span></h4>
                <h4><span name="attr_weapon10ap"></span></h4>
                <h4><span name="attr_weapon10traits"></span></h4>
            </div>
          </section>
        </main>
      </div>
    </div>    
</div>

<div class="sheet-abilities">
  <input type="hidden" name="attr_faction"/>
  <div class="mysheet">
      <div class="attributes">
          <input type="hidden" name="attr_faction"/>
          <div class="spheader">
              <h2>Special Rules & Traits</h2>
              <br>
          </div>
          <input type="hidden" name="attr_faction"/>
          <div class="spbody">
              <div class = "item">
                  <span style="font-weight:bold;" name="attr_spec1Name"></span>
                  <span name="attr_spec1Text"></span>
              </div>
              <div class = "item">
                  <span style="font-weight:bold;" name="attr_spec2Name"></span>
                  <span name="attr_spec2Text"></span>
              </div>
              <div class = "item">
                  <span style="font-weight:bold;" name="attr_spec3Name"></span>
                  <span name="attr_spec3Text"></span>
              </div>
              <div class = "item">                
                  <span style="font-weight:bold;" name="attr_spec4Name"></span>
                  <span name="attr_spec4Text"></span>
              </div>
              <div class = "item">                                
                  <span style="font-weight:bold;" name="attr_spec5Name"></span>
                  <span name="attr_spec5Text"></span>
              </div>
              <div class = "item">                
                  <span style="font-weight:bold;" name="attr_spec6Name"></span>
                  <span name="attr_spec6Text"></span>
              </div>
              <div class = "item">                
                  <span style="font-weight:bold;" name="attr_spec7Name"></span>
                  <span name="attr_spec7Text"></span>
              </div>
              <div class = "item">                
                  <span style="font-weight:bold;" name="attr_spec8Name"></span>
                  <span name="attr_spec8Text"></span>
              </div>
              <div class = "item">                
                  <span style="font-weight:bold;" name="attr_spec9Name"></span>
                  <span name="attr_spec9Text"></span>
              </div>
              <div class = "item">                
                  <span style="font-weight:bold;" name="attr_spec10Name"></span>
                  <span name="attr_spec10Text"></span>
              </div>
          </div>
      </div>
  </div>
</div>


<script type="text/worker">
    const buttonlist = ["input","display","abilities"];
    buttonlist.forEach(button => {
        on(`clicked:${button}`, function() {
            setAttrs({
                sheetTab: button
            });
        });
    });

    on("sheet:opened", function() {
        setAttrs({sheetTab:"display"});
    });

    on("change:attrs sheet:opened", function() { 
        getAttrs(["faction","special","type"], function(values) {
            let faction = values.faction;
            let factionImage,side;
            let type = values.type;
            let scale = 1;
            if (type === "Vehicle") {scale = 2};
            if (type === "Super-Heavy Vehicle") {scale=3};
            if (type === "Knight") {scale = 4};
            if (type === "Titan") {scale = 5};

            if (faction === "Ultramarines") {
                factionImage = "https://s3.amazonaws.com/files.d20.io/images/353049529/KtPvktw8dgMFRyHJIW-i6w/thumb.png?1690989195";
                side = "Loyalist ";
            }
            if (faction === "Blood Angels") {
                factionImage = "https://s3.amazonaws.com/files.d20.io/images/354261572/BMAsmC28Ap91qYIfra71yw/thumb.png?1691796541";
                side = "Loyalist "
            }
            if (faction === "Deathguard") {
                factionImage = "https://s3.amazonaws.com/files.d20.io/images/353239057/GIITPAhD-JdRRD2D6BREWw/thumb.png?1691112406";
                side = "Traitor ";
            } 
            if (faction === "Space Wolves") {
                factionImage = "https://s3.amazonaws.com/files.d20.io/images/360961940/GOg8nIXa8AfvA3v69KT-Vw/thumb.png?1695929748";
                side = "Loyalist ";
            }    
            if (faction === "Salamanders") {
                factionImage = "https://s3.amazonaws.com/files.d20.io/images/274614673/_-mcGObetfMZtFANsG7nKA/thumb.png?1646767013";
                side = "Loyalist ";
            }   
            if (faction === "Traitor Auxilia") {
                factionImage = "https://s3.amazonaws.com/files.d20.io/images/378070096/oShLaPkIOEq0P5y7YHHAmg/thumb.png?1706671346";
                side = "Traitor ";
            }   
            if (faction === "Loyalist Auxilia") {
                factionImage = "https://s3.amazonaws.com/files.d20.io/images/378123051/2-4fggKmqRdzsZiyLZetiQ/thumb.png?1706720638";
                side = "Loyalist ";
            }   
            if (faction === "House Malinax") {
                factionImage = "https://s3.amazonaws.com/files.d20.io/images/378121188/9nwrVJIN-ugGtz4PWL9Vng/thumb.png?1706719575";
                side = "Traitor ";
            }   
            if (faction === "Legio Mortis") {
                factionImage = "https://s3.amazonaws.com/files.d20.io/images/378121193/B0eCWKgF2pwdXXDCSlZp_Q/thumb.png?1706719579";
                side = "Traitor ";
            }   
            if (faction === "Legio Tempestus") {
                factionImage = "https://s3.amazonaws.com/files.d20.io/images/378121631/1G4APSKHrkuaGKsjJdC7dw/thumb.png?1706719812";
                side = "Loyalist ";
            }   
            if (faction === "House Raven") {
                factionImage = "https://s3.amazonaws.com/files.d20.io/images/378121596/GWag5rKj43mvsXnd4ah5dw/thumb.png?1706719790";
                side = "Loyalist ";
            }   

            let special = values.special;
            special = special.split(",");

            setAttrs({
                "scale": scale,
                "factionImage": factionImage,
                "side": side,
                "special0": special[0],
                "special1": special[1],
                "special2": special[2],
                "special3": special[3],
                "special4": special[4],
                "special5": special[5],
                "special6": special[6],
                "special7": special[7],
                "special8": special[8],
                "special9": special[9],



            });
        });    
    }); 


 

</script>